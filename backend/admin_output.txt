============================================================
FSOCIETY ADMIN ENDPOINTS TEST REPORT
============================================================


============================================================
üöÄ STARTING ADMIN ENDPOINTS TEST SUITE
============================================================
[2025-12-24 17:50:35] [INFO] Base URL: http://localhost:8000
[2025-12-24 17:50:35] [INFO] Admin User: admin@fsociety.test
[2025-12-24 17:50:35] [INFO] Output File: admin_output.txt

============================================================
üõ†Ô∏è  SETTING UP ADMIN USER
============================================================
[2025-12-24 17:50:37] [INFO] Admin login failed. Attempting to create regular user first...
[2025-12-24 17:50:37] [INFO] ‚ùå Failed to create test user. Tests may fail.

============================================================
üîê ADMIN AUTHENTICATION TESTS
============================================================
[33m‚ö† EXPECTED FAIL (Admin)[0m GET    /api/admin/users?limit=1                  403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}

============================================================
üë• ADMIN USER MANAGEMENT
============================================================
[31m‚úó FAIL[0m GET    /api/admin/users?limit=5                  403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m GET    /api/admin/users?limit=3&role=user&active_only=true  403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m GET    /api/admin/users/invalid-user-id-123      405 0.00s
   Error: HTTP 405
   Details: {
  "detail": "Method Not Allowed"
}

============================================================
üìä PLATFORM STATISTICS
============================================================
[31m‚úó FAIL[0m GET    /api/admin/stats                          403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m GET    /api/admin/activities?limit=10            403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m GET    /api/admin/activities?action=login&limit=5  403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m GET    /api/admin/activities?date_from=2024-01-01&limit=3  403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}

============================================================
üîç ADMIN SCAN MANAGEMENT
============================================================
[31m‚úó FAIL[0m GET    /api/admin/scans?limit=5                  404 0.00s
   Error: HTTP 404
   Details: {
  "detail": "Not Found"
}
[31m‚úó FAIL[0m GET    /api/scans/admin/all?limit=3              403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m DELETE /api/scans/admin/invalid-scan-id-123      403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}

============================================================
üõ°Ô∏è ADMIN SECURITY ENDPOINTS
============================================================
[31m‚úó FAIL[0m GET    /api/security/cache/stats                 403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m GET    /api/security/cache/entries?limit=5       403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m POST   /api/security/cache/clear?cache_type=ssl  403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m POST   /api/security/cache/clear                 403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}

============================================================
üìÅ ADMIN FILE ANALYSIS
============================================================
[31m‚úó FAIL[0m GET    /api/files/malware/database               403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}
[31m‚úó FAIL[0m POST   /api/files/malware/database/update        403 0.00s
   Error: HTTP 403
   Details: {
  "detail": "Not authenticated"
}

============================================================
‚öôÔ∏è SYSTEM ENDPOINTS
============================================================
[32m‚úì PASS[0m GET    /api/security/health/detailed             200 0.04s
[32m‚úì PASS[0m GET    /status                                   200 0.00s
[32m‚úì PASS[0m GET    /health                                   200 0.00s
[32m‚úì PASS[0m GET    /                                         200 0.00s

============================================================
üìä ADMIN TESTS SUMMARY
============================================================
Total Tests          21
‚úÖ Passed             4
‚ö†Ô∏è Expected Fails    1
‚ùå Unexpected Fails   16
Success Rate         19.0%
Avg Response Time    0.00s

============================================================
üìà ENDPOINT BREAKDOWN
============================================================
  ‚ùå USERS       0/ 4 (  0.0%)
  ‚ùå STATS       0/ 4 (  0.0%)
  ‚ùå SCANS       0/ 3 (  0.0%)
  ‚ùå SECURITY    0/ 4 (  0.0%)
  ‚ùå FILES       0/ 2 (  0.0%)
  ‚úÖ SYSTEM      4/ 4 (100.0%)

============================================================
üî¥ UNEXPECTED FAILURES
============================================================
‚ùå GET /api/admin/users?limit=5: HTTP 403
‚ùå GET /api/admin/users?limit=3&role=user&active_only=true: HTTP 403
‚ùå GET /api/admin/users/invalid-user-id-123: HTTP 405
‚ùå GET /api/admin/stats: HTTP 403
‚ùå GET /api/admin/activities?limit=10: HTTP 403
‚ùå GET /api/admin/activities?action=login&limit=5: HTTP 403
‚ùå GET /api/admin/activities?date_from=2024-01-01&limit=3: HTTP 403
‚ùå GET /api/admin/scans?limit=5: HTTP 404
‚ùå GET /api/scans/admin/all?limit=3: HTTP 403
‚ùå DELETE /api/scans/admin/invalid-scan-id-123: HTTP 403
‚ùå GET /api/security/cache/stats: HTTP 403
‚ùå GET /api/security/cache/entries?limit=5: HTTP 403
‚ùå POST /api/security/cache/clear?cache_type=ssl: HTTP 403
‚ùå POST /api/security/cache/clear: HTTP 403
‚ùå GET /api/files/malware/database: HTTP 403
‚ùå POST /api/files/malware/database/update: HTTP 403

============================================================
‚ö†Ô∏è EXPECTED FAILURES (Admin Access Required)
============================================================
‚ö†Ô∏è GET /api/admin/users?limit=1: Admin access required

============================================================
üí° RECOMMENDATIONS
============================================================
  ‚ùå Needs improvement. Review failed endpoints.
  ‚ùå Fix 16 unexpected failure(s).

============================================================
üéØ FINAL VERDICT
============================================================
üî¥ POOR. Admin endpoints need major fixes.
[2025-12-24 17:50:37] [INFO] 
üìÅ Detailed results saved to: admin_results.json
[2025-12-24 17:50:37] [INFO] üìÅ Log file: admin_output.txt
